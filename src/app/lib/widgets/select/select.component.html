<ng-template #baseSelect>
  <div [ngClass]="{'row': labelPosition === 'left', 'm-0': true}">
    @if (!nolabel) {
      <lfb-label
        [for]="id+_id"
        [title]="schema.title"
        [helpMessage]="schema.description"
        [ngClass]="labelClasses"
      ></lfb-label>
    }
    <div [ngClass]="controlClasses">
      @if (schema.type !== 'array') {
        <select
          [formControl]="control"
          name="{{name}}"
          [attr.id]="id+_id"
          [ngClass]="{invalid: errors}"
          [attr.aria-invalid]="errors"
          (focus)="announceErrors()"
          [attr.disabled]="schema.readOnly ? '' : null"
          class="form-select form-select-sm">
          @if (schema.oneOf) {
            @for (option of schema.oneOf; track option.enum[0]) {
              <option
              [ngValue]="option.enum[0]" >{{option.description}}</option>
            }
          } @else {
            @for (option of allowedOptions; track option.value) {
              <option
              [ngValue]="option.value" >{{option.label}}</option>
            }
          }
        </select>
      }

      @if (schema.type==='array') {
        <select multiple
          [formControl]="control"
          name="{{name}}"
          [attr.id]="id+_id"
          [ngClass]="{invalid: errors}"
          [attr.aria-invalid]="errors"
          (focus)="announceErrors()"
          [attr.disabled]="schema.readOnly ? '' : null">
          @for (option of schema.items.oneOf; track option.enum[0]) {
            <option
              [ngValue]="option.enum[0]"
            [attr.disabled]="option.readOnly ? '' : null">{{option.description}}</option>
          }
        </select>
      }

      @for (error of errors; track error.code) {
        <fa-icon [attr.id]="error.code" [icon]="errorIcon" style="color: red"></fa-icon>
        @if (formProperty.value && error) {
          <small
            class="text-danger form-text" role="alert"
          >{{error.modifiedMessage || error.originalMessage}}</small>
        }
      }

    </div>
    @if (schema.readOnly) {
      <input name="{{name}}" type="hidden" [formControl]="control">
    }
  </div>
</ng-template>

<ng-container *ngTemplateOutlet="baseSelect">

</ng-container>

